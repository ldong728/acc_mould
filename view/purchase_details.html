<style>
    .attr-input{display: none; z-index: 99; position: fixed;left: 50%;top: 50%; width: 500px;height: 350px;padding: 30px;box-sizing: border-box; margin-left:  -250px;margin-top: -175px;background-color: #fff;}
</style>

<div class="home">
    <div class="container">
        <div class="pu-container">
            <div class="pu-breadcrumbs clearfix">
                <ul class="clearfix">
                    <li><a href="index.html">首页</a></li>
                    <span>&gt;</span>
                    <li><a href="purchase.html">我要采购</a></li>
                    <span>&gt;</span>
                    <li><a class="product-inf" data-field="category_name"></a></li>
                </ul>
                <p class="number">共找到<span class="light">1234</span>信息</p>
            </div>
            <div class="pu-details">
                <div class="pu-details-info clearfix">
                    <div class="pd-info-l">
                        <p class="big-img"><img class="current-img" src="images/lm.jpg"></p>
                        <ul class="ul-img clearfix img-container">
                            <li class="img-template"><img class="small-image" src="images/lm.jpg"></li>
                        </ul>
                    </div>
                    <div class="pd-info-r">
                        <div class="pd-info-title clearfix">
                            <h2 class="product-inf" data-field="product_name">模具加工</h2>
                            <a href="purchase_demand.html">发布采购需求</a>
                        </div>
                        <ol class="pd-info-number clearfix">
                            <li>
                                <p class="red">￥100.00</p>

                                <p class="num">10-99台</p>
                            </li>
                            <!--<li>-->
                                <!--<p class="red">￥95.00</p>-->

                                <!--<p class="num">100-4999台</p>-->
                            <!--</li>-->
                            <!--<li>-->
                                <!--<p class="red">￥90.00</p>-->

                                <!--<p class="num">≥5000台</p>-->
                            <!--</li>-->
                        </ol>
                        <ul class="pd-info-content">
                            <!--<li>-->
                                <!--<p class="li-l">规格</p>-->

                                <!--<p class="li-r">这里是规格</p>-->
                            <!--</li>-->
                            <li>
                                <p class="li-l">发货地</p>

                                <p class="li-r product-inf" data-field="shipping_place">浙江省宁波市</p>
                            </li>
                            <li>
                                <p class="li-l">发货期</p>

                                <p class="li-r"><span class="light product-inf" data-field="delivery_time">3</span>天以内</p>
                            </li>
                            <li>
                                <p class="li-l">运费说明</p>

                                <p class="li-r product-inf" data-field="shipping_instr">买家承担</p>
                            </li>
                            <li>
                                <p class="li-l">支付方式</p>

                                <p class="li-r"><span>支付宝</span><span>微信</span><span>网上银行</span><span>PayPal</span></p>
                            </li>
                        </ul>
                        <div class="pd-info-shop clearfix">
                            <p class="li-l">订购数量</p>

                            <div class="shop-r">
                                <div class="top">
                                    <span class="less"><i class="icon icon-minus"></i></span><span>10</span><span
                                        class="plus"><i class="icon icon-plus"></i></span>
                                </div>
                                <div class="bottom">
                                    <button class="add-shop add-to-cart"><i class="icon icon-shopping-cart"></i>加入购物车</button>
                                    <a href="purchase_demand.html" class="xj">立即询价</a>
                                    <button type="button" class="contact">联系信息</button>
                                </div>
                            </div>
                        </div>
                        <div class="pd-protection clearfix">
                            <p class="li-l">订购数量</p>

                            <div class="protection-r">
                                <img src="images/bao.png">
                                <span>卖家支持先行赔付，保障卖家交易安全</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="pu-details-parameter">
                    <ul class="clearfix">
                        <li class="li-cur detail-switch" data-field="product_detail">商品详情</li>
                        <li class="detail-switch" data-field="size_detail">规格参数</li>
                        <!--<li>联系方式</li>-->
                    </ul>
                    <div class="parameter-content">
                        <img src="images/lm.jpg">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="site-footer">
    <div class="footer-link clearfix">
        <div class="container">
            <div class="footer-link-l">
                <dl>
                    <dt>购物指南</dt>
                    <dd><a href="#">快捷支付</a></dd>
                    <dd><a href="#">交付选项</a></dd>
                    <dd><a href="#">卖家保护</a></dd>
                    <dd><a href="#">新用户指南</a></dd>
                </dl>
                <dl>
                    <dt>商家服务</dt>
                    <dd><a href="#">商家入驻</a></dd>
                    <dd><a href="#">商家中心</a></dd>
                    <dd><a href="#">物流服务</a></dd>
                    <dd><a href="#">运营服务</a></dd>
                </dl>
                <dl>
                    <dt>平台保障</dt>
                    <dd><a href="#">客服中心</a></dd>
                    <dd><a href="#">交易服务协议</a></dd>
                    <dd><a href="#">接收我们的调查</a></dd>
                    <dd><a href="#">组织&技术支持</a></dd>
                    <dd><a href="#">报告侵犯知识产权</a></dd>
                </dl>
                <dl>
                    <dt>合作伙伴推广</dt>
                    <dd><a href="#">合作伙伴关系</a></dd>
                    <dd><a href="#">开放平台</a></dd>
                    <dd><a href="#">网站合作</a></dd>
                </dl>
                <dl>
                    <dt>联系我们</dt>
                    <dd>咨询热线：400-0000-0000</dd>
                    <dd>邮箱：accmould@163.com</dd>
                    <dd>工作时间：周一至周五 9:00～17:00</dd>
                </dl>
            </div>
            <div class="wx-code">
                <p class="img"><img src="images/wx-code.jpg" alt=""></p>

                <p class="text">关注官方微信</p>
            </div>
        </div>
    </div>
    <div class="footer-friend-link">
        <div class="container">
            <span>友情链接：</span>
            <a href="#">Acc+Mould Group</a>
            <a href="#">China mold network</a>
            <a href="#">China's technology network</a>
            <a href="#">Juhuasuan</a>
            <a href="#">boc.cn</a>
            <a href="#">icbc.com.cn</a>
            <a href="#">abchina.com Acc+Mould Cloud</a>
            <a href="#">YunOS</a>
            <a href="#">AliTeleco</a>
        </div>
    </div>
</div>

<div class="contact-message">
    <h2 class="title">联系信息<i class="icon icon-remove"></i></h2>

    <div class="message">
        <p>
            <span class="img"><img src="images/co2.png"></span>手机号：<span class="red">13400000000</span>
        </p>

        <p>
            <span class="img"> <img src="images/co1.png"></span>电&nbsp;&nbsp;&nbsp;话：0574-68686868
        </p>

        <p>
            <span class="img">
                <img src="images/co3.png">
            </span>联系人：陈先生
        </p>

        <p>
            <span class="img">
                <img src="images/co4.png">
            </span>公&nbsp;&nbsp;&nbsp;司：<span class="product-inf" data-field="company_name">某某某公司（普通会员）</span>
        </p>

        <p>
            <span class="img">
                <img src="images/co5.png">
            </span>地&nbsp;&nbsp;&nbsp;址：<span class="product-inf" data-field="company_address">浙江省宁波市</span>
        </p>
    </div>
</div>
<div class="attr-input">
    <div class="calc-value"><span class="attr-name"></span>:<input type="number"><span class="attr-unit"></span></div>
    <div class="file-value"><span class="attr-name"></span><input type="file" name="file-up" id="file-up"></div>
</div>


<script>
    var bodyHeight = $('body').height();
    $(function () {


        $(document).on('click', '.contact', function () {
            $('.contact-message').show();
            $('body').append('<div class="mask"></div>');
            $('.mask').height(bodyHeight);
        });

        $(document).on('click', '.mask', function () {
            $('.contact-message').hide();
            $('.attr-input').hide();
            $('.mask').remove();
        });

        $(document).on('click', '.contact-message', function () {
            $('.contact-message').hide();
            $('.mask').remove();
        })
    });
</script>
<script>
    var productId=sessionStorage.currentProductId;
    var categoryAttr;
    var orderAttr={};
    var productInf;
    var calFunction={};
    var inputCreator=prepareElement('.calc-value');
    var fileCreator=prepareElement('.file-value');
    $(document).ready(function(){
        if(productId){
            initProductInf();
            registEvent();
        }
    });
    function registEvent(){
        $(document).on('click','.detail-switch',function(){
            console.log('click');
            $('.detail-switch').removeClass('li-cur');
            $(this).addClass('li-cur');
            var field=$(this).data('field');
            $('.parameter-content').html(productInf[field]);
        });
        $(document).on('click','.add-to-cart',function(){
           $('.attr-input').show();
            $('body').append('<div class="mask"></div>');
            $('.mask').height(bodyHeight);
        });
    }
    function initProductInf(){
        var _=this;
        ajaxPost('product','detail',{product_id:productId},function(back){
            var backValue=backHandle(back);
            if(backValue){
                console.log(backValue);
                categoryAttr=backValue.attrs;
                productInf=backValue.detail;
                $('.product-inf').each(function(k,v){
                    var field=$(this).data('field');
                    $(v).text(productInf[field]);
                    $(v).removeAttr('data-field');
                });
                $('.parameter-content').html(productInf.product_detail);
                var img=JSON.parse(productInf.img);
                $('.current-img').attr('src',img['product-img'][0]);
                var imgCreator= _.prepareElement('.img-template');
                for(var i in img['product-img']){
                    var sImg=imgCreator();
                    sImg.find('.small-image').attr('src',img['product-img'][i]);
                    $('.img-container').append(sImg);
                }
                setAttrs(_);

//                console.log(categoryAttr);
//                console.log(attr);

            }
        });

    }
    function setAttrs(){
        var attr=JSON.parse(productInf.product_attr);
        for(var i in categoryAttr){
            if(attr[i])categoryAttr[i]=attr[i];
            console.log(categoryAttr[i]);
            if(4==categoryAttr[i].attr_pms){
                orderAttr[i]=categoryAttr[i];
                switch(categoryAttr[i].attr_type){
                    case'number':
                        var inputElement=inputCreator();
                        inputElement.find('.attr-name').text(categoryAttr[i].category_attr_name);
                        inputElement.find('.attr-unit').text(categoryAttr[i].attr_unit);
                        inputElement.find('input').attr('id',categoryAttr[i].category_attr_id);
                            $('.attr-input').append(inputElement);
                        break;

                    case'file':
                        var fileElement=fileCreator();

                            $('.attr-input').append(fileElement);
                        break;

                    case 'func':
                        calFunction=eval('('+categoryAttr[i].value+')');
                        break;

                    default:
                        break;



                }
            }
        }
    }



</script>